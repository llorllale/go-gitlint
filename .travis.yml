dist: trusty

language: go
go:
  - "1.13.x"
env:
  - GO111MODULE=on
install:
  - gem install pdd
  - curl -sfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh| sh -s -- -b $(go env GOPATH)/bin v1.18.0
  - GO111MODULE=off go get github.com/comcast/weasel
jobs:
  include:
  - if: (type = pull_request) OR (type = push AND branch = master)
    script: make checks && 
            bash <(curl -s https://codecov.io/bash)
  - if: tag IS present
    script: make checks && 
            bash <(curl -s https://codecov.io/bash) && 
            make release
